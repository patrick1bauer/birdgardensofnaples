services:
  guacamole: # Remote Desktop Web Client
    image: ghcr.io/linuxserver/guacamole:latest
    container_name: guacamole
    restart: unless-stopped
    security_opt:
      - no-new-privileges:true
    depends_on:
      - guacd
      - postgres
      # gluetun:
      #   condition: service_healthy
    links:
      - guacd
    # network_mode: "service:gluetun"
    networks:
      - guacamole_network
    ports:
      - "8080:8080"
    secrets:
      - guacamole_postgres_user
      - guacamole_postgres_password
    environment:
      PUID: $PUID
      PGID: $PGID
      TZ: $TZ
      GUACD_HOSTNAME: guacd
      POSTGRES_DATABASE: guacamole_db
      POSTGRES_HOSTNAME: postgres
      POSTGRES_PASSWORD: /run/secrets/guacamole_postgres_password
      POSTGRES_USER: /run/secrets/guacamole_postgres_user
